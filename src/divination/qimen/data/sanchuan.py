"""
三传数据
大六壬三传速查表 - 用于六壬起课推算

三传说明：
- 初传（发用）：课体之源，事情之始
- 中传（用神）：事情发展过程
- 末传（传送）：事情之终结

数据来源：马年测算系统 qmdj/sanchuan.txt
格式：日干支序号 -> 12时辰对应的三传
"""
from typing import List, Tuple, Optional


# 十二地支时辰对应
SHI_CHEN = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥']

# 三传数据表
# 格式：{日干支序号(1-60): [12个时辰的三传, 每个三传为(初传,中传,末传)]}
SAN_CHUAN_TABLE = {
    1: [('寅', '巳', '申'), ('子', '亥', '戌'), ('戌', '申', '午'), ('午', '卯', '子'), ('戌', '午', '寅'), ('寅', '酉', '辰'), ('寅', '申', '寅'), ('子', '巳', '戌'), ('辰', '申', '子'), ('申', '亥', '寅'), ('辰', '午', '申'), ('辰', '巳', '午')],
    2: [('寅', '巳', '申'), ('子', '亥', '戌'), ('戌', '申', '午'), ('丑', '亥', '亥'), ('戌', '午', '寅'), ('酉', '辰', '亥'), ('寅', '申', '寅'), ('子', '巳', '戌'), ('申', '午', '午'), ('申', '亥', '寅'), ('辰', '午', '申'), ('辰', '巳', '午')],
    3: [('寅', '巳', '申'), ('子', '亥', '戌'), ('戌', '申', '午'), ('申', '巳', '寅'), ('子', '申', '辰'), ('午', '丑', '申'), ('寅', '申', '寅'), ('寅', '未', '子'), ('申', '子', '辰'), ('申', '亥', '寅'), ('辰', '午', '申'), ('辰', '巳', '午')],
    4: [('寅', '巳', '申'), ('子', '亥', '戌'), ('戌', '申', '午'), ('申', '巳', '寅'), ('戌', '午', '寅'), ('酉', '辰', '亥'), ('寅', '申', '寅'), ('子', '巳', '戌'), ('寅', '午', '戌'), ('申', '亥', '寅'), ('辰', '午', '申'), ('辰', '巳', '午')],
    5: [('寅', '巳', '申'), ('子', '亥', '戌'), ('午', '辰', '寅'), ('巳', '寅', '亥'), ('子', '申', '辰'), ('戌', '巳', '子'), ('寅', '申', '寅'), ('子', '巳', '戌'), ('辰', '申', '子'), ('申', '亥', '寅'), ('辰', '午', '申'), ('辰', '巳', '午')],
    6: [('寅', '巳', '申'), ('子', '亥', '戌'), ('午', '辰', '寅'), ('申', '巳', '寅'), ('戌', '午', '寅'), ('子', '未', '寅'), ('寅', '申', '寅'), ('子', '巳', '戌'), ('寅', '午', '戌'), ('申', '亥', '寅'), ('辰', '午', '申'), ('辰', '巳', '午')],
    7: [('辰', '丑', '戌'), ('子', '亥', '戌'), ('亥', '酉', '未'), ('丑', '戌', '未'), ('巳', '丑', '酉'), ('卯', '戌', '巳'), ('戌', '辰', '戌'), ('寅', '未', '子'), ('酉', '丑', '巳'), ('未', '戌', '丑'), ('申', '戌', '子'), ('寅', '卯', '辰')],
    8: [('辰', '卯', '子'), ('丑', '子', '亥'), ('亥', '酉', '未'), ('丑', '戌', '未'), ('未', '卯', '亥'), ('午', '丑', '申'), ('卯', '酉', '卯'), ('寅', '未', '子'), ('未', '亥', '卯'), ('酉', '子', '卯'), ('申', '戌', '子'), ('辰', '巳', '午')],
    9: [('辰', '巳', '申'), ('卯', '寅', '丑'), ('丑', '亥', '酉'), ('丑', '戌', '未'), ('酉', '巳', '丑'), ('午', '丑', '申'), ('巳', '亥', '巳'), ('寅', '未', '子'), ('酉', '丑', '巳'), ('未', '戌', '丑'), ('申', '戌', '子'), ('未', '申', '酉')],
    10: [('辰', '未', '丑'), ('戌', '卯', '午'), ('亥', '酉', '巳'), ('丑', '戌', '未'), ('卯', '亥', '未'), ('午', '丑', '申'), ('戌', '辰', '戌'), ('巳', '戌', '卯'), ('亥', '卯', '未'), ('未', '戌', '丑'), ('申', '戌', '子'), ('酉', '戌', '亥')],
    11: [('辰', '酉', '卯'), ('申', '未', '午'), ('未', '巳', '卯'), ('丑', '戌', '未'), ('巳', '丑', '酉'), ('亥', '午', '丑'), ('卯', '酉', '卯'), ('未', '子', '巳'), ('申', '子', '辰'), ('未', '戌', '丑'), ('申', '戌', '子'), ('亥', '子', '丑')],
    12: [('辰', '亥', '巳'), ('戌', '酉', '申'), ('酉', '未', '巳'), ('丑', '戌', '未'), ('未', '卯', '亥'), ('午', '丑', '申'), ('巳', '亥', '巳'), ('寅', '未', '子'), ('未', '亥', '卯'), ('未', '戌', '丑'), ('申', '戌', '子'), ('丑', '寅', '卯')],
    13: [('巳', '申', '寅'), ('戌', '酉', '申'), ('丑', '亥', '酉'), ('午', '卯', '子'), ('申', '辰', '子'), ('子', '未', '寅'), ('午', '子', '午'), ('巳', '戌', '卯'), ('酉', '丑', '巳'), ('申', '亥', '寅'), ('辰', '午', '申'), ('寅', '卯', '辰')],
    14: [('巳', '申', '寅'), ('子', '亥', '戌'), ('丑', '亥', '酉'), ('亥', '申', '巳'), ('戌', '午', '寅'), ('子', '未', '寅'), ('寅', '申', '寅'), ('子', '巳', '戌'), ('酉', '丑', '巳'), ('申', '亥', '寅'), ('辰', '午', '申'), ('辰', '巳', '午')],
    15: [('巳', '申', '寅'), ('卯', '寅', '丑'), ('丑', '亥', '酉'), ('亥', '申', '巳'), ('子', '申', '辰'), ('午', '丑', '申'), ('巳', '亥', '巳'), ('寅', '未', '子'), ('酉', '丑', '巳'), ('申', '亥', '寅'), ('申', '戌', '子'), ('亥', '午', '午')],
    16: [('巳', '申', '寅'), ('卯', '寅', '丑'), ('丑', '亥', '酉'), ('子', '酉', '午'), ('戌', '午', '寅'), ('子', '未', '寅'), ('午', '子', '午'), ('辰', '酉', '寅'), ('酉', '丑', '巳'), ('申', '亥', '寅'), ('申', '戌', '子'), ('申', '酉', '戌')],
    17: [('巳', '申', '寅'), ('卯', '寅', '丑'), ('丑', '亥', '酉'), ('巳', '寅', '亥'), ('子', '申', '辰'), ('戌', '巳', '子'), ('寅', '申', '寅'), ('卯', '申', '丑'), ('酉', '丑', '巳'), ('申', '辰', '寅'), ('子', '寅', '辰'), ('酉', '戌', '亥')],
    18: [('巳', '申', '寅'), ('卯', '寅', '丑'), ('丑', '亥', '酉'), ('亥', '申', '巳'), ('酉', '巳', '丑'), ('子', '未', '寅'), ('巳', '亥', '巳'), ('申', '丑', '午'), ('酉', '丑', '巳'), ('申', '亥', '寅'), ('子', '寅', '辰'), ('亥', '子', '丑')],
    19: [('丑', '戌', '未'), ('子', '亥', '戌'), ('亥', '酉', '未'), ('子', '辰', '戌'), ('巳', '丑', '酉'), ('卯', '戌', '巳'), ('亥', '未', '丑'), ('巳', '戌', '卯'), ('酉', '丑', '巳'), ('午', '戌', '辰'), ('酉', '亥', '丑'), ('申', '酉', '戌')],
    20: [('卯', '子', '午'), ('丑', '子', '亥'), ('亥', '酉', '未'), ('子', '酉', '午'), ('未', '卯', '亥'), ('戌', '巳', '子'), ('卯', '酉', '卯'), ('巳', '戌', '卯'), ('未', '亥', '卯'), ('酉', '子', '卯'), ('酉', '亥', '丑'), ('辰', '巳', '午')],
    21: [('巳', '申', '寅'), ('卯', '寅', '丑'), ('丑', '亥', '酉'), ('亥', '申', '巳'), ('亥', '未', '卯'), ('酉', '辰', '亥'), ('巳', '亥', '巳'), ('巳', '戌', '卯'), ('酉', '丑', '巳'), ('申', '亥', '寅'), ('酉', '亥', '丑'), ('申', '酉', '戌')],
    22: [('未', '丑', '戌'), ('卯', '午', '午'), ('丑', '巳', '巳'), ('亥', '辰', '辰'), ('卯', '亥', '未'), ('酉', '辰', '亥'), ('巳', '丑', '丑'), ('巳', '戌', '卯'), ('亥', '卯', '未'), ('亥', '戌', '戌'), ('酉', '亥', '丑'), ('申', '酉', '戌')],
    23: [('酉', '未', '丑'), ('申', '未', '午'), ('丑', '巳', '巳'), ('午', '卯', '子'), ('巳', '丑', '酉'), ('亥', '午', '丑'), ('卯', '酉', '卯'), ('未', '子', '巳'), ('亥', '卯', '未'), ('子', '卯', '午'), ('酉', '亥', '丑'), ('亥', '子', '丑')],
    24: [('亥', '未', '丑'), ('戌', '酉', '申'), ('酉', '未', '巳'), ('巳', '寅', '亥'), ('未', '卯', '亥'), ('午', '丑', '申'), ('巳', '亥', '巳'), ('巳', '戌', '卯'), ('未', '亥', '卯'), ('午', '戌', '寅'), ('酉', '亥', '丑'), ('申', '酉', '戌')],
    25: [('巳', '申', '寅'), ('戌', '酉', '申'), ('丑', '亥', '酉'), ('寅', '亥', '申'), ('巳', '申', '丑'), ('子', '未', '寅'), ('午', '子', '午'), ('巳', '戌', '卯'), ('辰', '申', '子'), ('卯', '午', '酉'), ('辰', '午', '申'), ('寅', '卯', '辰')],
    26: [('巳', '申', '寅'), ('子', '亥', '戌'), ('丑', '亥', '酉'), ('寅', '亥', '申'), ('戌', '午', '寅'), ('子', '未', '寅'), ('寅', '申', '寅'), ('子', '巳', '戌'), ('丑', '午', '酉'), ('申', '亥', '寅'), ('辰', '午', '申'), ('辰', '巳', '午')],
    27: [('巳', '申', '寅'), ('卯', '寅', '丑'), ('丑', '亥', '酉'), ('寅', '亥', '申'), ('子', '申', '辰'), ('子', '未', '寅'), ('巳', '亥', '巳'), ('寅', '未', '子'), ('子', '辰', '申'), ('亥', '寅', '巳'), ('申', '戌', '子'), ('寅', '午', '午')],
    28: [('巳', '申', '寅'), ('卯', '寅', '丑'), ('丑', '亥', '酉'), ('寅', '亥', '申'), ('戌', '午', '寅'), ('子', '未', '寅'), ('午', '子', '午'), ('辰', '酉', '寅'), ('寅', '午', '戌'), ('酉', '子', '卯'), ('申', '戌', '子'), ('寅', '午', '午')],
    29: [('巳', '申', '寅'), ('卯', '寅', '丑'), ('丑', '亥', '酉'), ('寅', '亥', '申'), ('子', '申', '辰'), ('子', '未', '寅'), ('寅', '申', '寅'), ('卯', '申', '丑'), ('辰', '申', '子'), ('寅', '巳', '申'), ('子', '寅', '辰'), ('戌', '酉', '午')],
    30: [('巳', '申', '寅'), ('卯', '寅', '丑'), ('丑', '亥', '酉'), ('寅', '亥', '申'), ('寅', '戌', '午'), ('子', '未', '寅'), ('巳', '亥', '巳'), ('申', '丑', '午'), ('寅', '午', '戌'), ('亥', '寅', '巳'), ('子', '寅', '辰'), ('亥', '子', '丑')],
    31: [('丑', '戌', '未'), ('子', '亥', '戌'), ('亥', '酉', '未'), ('子', '辰', '戌'), ('巳', '丑', '酉'), ('卯', '戌', '巳'), ('亥', '未', '丑'), ('巳', '戌', '卯'), ('酉', '丑', '巳'), ('午', '戌', '辰'), ('卯', '巳', '未'), ('寅', '卯', '辰')],
    32: [('卯', '子', '午'), ('丑', '子', '亥'), ('亥', '酉', '未'), ('子', '酉', '午'), ('未', '卯', '亥'), ('戌', '巳', '子'), ('卯', '酉', '卯'), ('巳', '戌', '卯'), ('未', '亥', '卯'), ('酉', '子', '卯'), ('亥', '丑', '卯'), ('辰', '巳', '午')],
    33: [('巳', '申', '寅'), ('卯', '寅', '丑'), ('丑', '亥', '酉'), ('寅', '亥', '申'), ('卯', '亥', '未'), ('酉', '辰', '亥'), ('巳', '亥', '巳'), ('巳', '戌', '卯'), ('酉', '丑', '巳'), ('申', '亥', '寅'), ('亥', '丑', '卯'), ('申', '申', '午')],
    34: [('未', '丑', '戌'), ('卯', '午', '午'), ('丑', '巳', '巳'), ('亥', '辰', '辰'), ('卯', '亥', '未'), ('酉', '辰', '亥'), ('巳', '丑', '丑'), ('巳', '戌', '卯'), ('亥', '卯', '未'), ('亥', '戌', '戌'), ('酉', '酉', '酉'), ('未', '申', '申')],
    35: [('酉', '未', '丑'), ('戌', '酉', '申'), ('卯', '丑', '亥'), ('午', '卯', '子'), ('卯', '亥', '未'), ('亥', '午', '丑'), ('卯', '酉', '卯'), ('未', '子', '巳'), ('亥', '卯', '未'), ('卯', '午', '酉'), ('丑', '卯', '巳'), ('亥', '子', '丑')],
    36: [('亥', '未', '丑'), ('戌', '酉', '申'), ('卯', '丑', '亥'), ('巳', '寅', '亥'), ('未', '卯', '亥'), ('午', '丑', '申'), ('巳', '亥', '巳'), ('巳', '戌', '卯'), ('未', '亥', '卯'), ('寅', '巳', '申'), ('丑', '卯', '巳'), ('丑', '寅', '卯')],
    37: [('申', '寅', '巳'), ('戌', '酉', '申'), ('午', '辰', '寅'), ('午', '卯', '子'), ('子', '申', '辰'), ('戌', '巳', '子'), ('寅', '申', '寅'), ('巳', '戌', '卯'), ('辰', '申', '子'), ('午', '酉', '子'), ('辰', '午', '申'), ('寅', '卯', '辰')],
    38: [('申', '寅', '巳'), ('子', '亥', '戌'), ('午', '辰', '寅'), ('巳', '寅', '亥'), ('子', '申', '辰'), ('戌', '巳', '子'), ('寅', '申', '寅'), ('子', '巳', '戌'), ('辰', '申', '子'), ('申', '亥', '寅'), ('辰', '午', '申'), ('辰', '巳', '午')],
    39: [('申', '寅', '巳'), ('卯', '寅', '丑'), ('寅', '子', '戌'), ('巳', '寅', '亥'), ('子', '申', '辰'), ('午', '丑', '申'), ('寅', '申', '寅'), ('寅', '未', '子'), ('辰', '申', '子'), ('寅', '巳', '申'), ('申', '戌', '子'), ('午', '未', '申')],
    40: [('申', '寅', '巳'), ('午', '巳', '辰'), ('午', '辰', '寅'), ('巳', '寅', '亥'), ('子', '申', '辰'), ('戌', '巳', '子'), ('寅', '申', '寅'), ('辰', '酉', '寅'), ('辰', '申', '子'), ('酉', '子', '卯'), ('申', '戌', '子'), ('戌', '未', '酉')],
    41: [('申', '寅', '巳'), ('酉', '申', '未'), ('午', '辰', '寅'), ('巳', '寅', '亥'), ('子', '申', '辰'), ('戌', '巳', '子'), ('寅', '申', '寅'), ('卯', '丑', '丑'), ('辰', '申', '子'), ('丑', '亥', '亥'), ('子', '寅', '辰'), ('亥', '酉', '酉')],
    42: [('申', '寅', '巳'), ('午', '巳', '辰'), ('午', '辰', '寅'), ('巳', '寅', '亥'), ('子', '申', '辰'), ('戌', '巳', '子'), ('寅', '申', '寅'), ('申', '丑', '午'), ('辰', '申', '子'), ('寅', '巳', '申'), ('子', '寅', '辰'), ('亥', '子', '丑')],
    43: [('丑', '戌', '未'), ('子', '亥', '戌'), ('亥', '酉', '未'), ('巳', '未', '未'), ('巳', '丑', '酉'), ('卯', '戌', '巳'), ('亥', '未', '辰'), ('卯', '申', '丑'), ('酉', '丑', '巳'), ('巳', '丑', '丑'), ('卯', '巳', '未'), ('寅', '卯', '辰')],
    44: [('卯', '子', '午'), ('丑', '子', '亥'), ('亥', '酉', '未'), ('子', '未', '子'), ('未', '卯', '亥'), ('戌', '巳', '子'), ('卯', '酉', '卯'), ('卯', '申', '丑'), ('未', '亥', '卯'), ('酉', '子', '卯'), ('巳', '未', '酉'), ('辰', '巳', '午')],
    45: [('巳', '申', '寅'), ('卯', '寅', '丑'), ('丑', '亥', '酉'), ('寅', '亥', '申'), ('午', '寅', '戌'), ('未', '寅', '酉'), ('巳', '亥', '巳'), ('卯', '申', '丑'), ('酉', '丑', '巳'), ('申', '亥', '寅'), ('寅', '辰', '午'), ('午', '未', '申')],
    46: [('未', '丑', '戌'), ('巳', '辰', '卯'), ('午', '辰', '寅'), ('亥', '未', '未'), ('卯', '亥', '未'), ('酉', '辰', '亥'), ('巳', '丑', '辰'), ('巳', '戌', '卯'), ('亥', '卯', '未'), ('亥', '丑', '丑'), ('寅', '辰', '午'), ('申', '亥', '申')],
    47: [('酉', '戌', '未'), ('丑', '酉', '酉'), ('午', '辰', '寅'), ('午', '卯', '子'), ('巳', '丑', '酉'), ('亥', '午', '丑'), ('卯', '酉', '卯'), ('未', '子', '巳'), ('寅', '午', '戌'), ('卯', '午', '酉'), ('丑', '卯', '巳'), ('亥', '子', '丑')],
    48: [('亥', '戌', '未'), ('戌', '酉', '申'), ('午', '辰', '寅'), ('巳', '寅', '亥'), ('未', '卯', '亥'), ('午', '丑', '申'), ('巳', '亥', '巳'), ('卯', '申', '丑'), ('未', '亥', '卯'), ('巳', '申', '亥'), ('丑', '卯', '巳'), ('丑', '寅', '卯')],
    49: [('亥', '子', '卯'), ('戌', '酉', '申'), ('戌', '申', '午'), ('午', '卯', '子'), ('未', '卯', '亥'), ('午', '丑', '申'), ('午', '子', '午'), ('巳', '戌', '卯'), ('未', '亥', '卯'), ('午', '酉', '子'), ('辰', '午', '申'), ('寅', '卯', '辰')],
    50: [('亥', '寅', '巳'), ('子', '亥', '戌'), ('戌', '申', '午'), ('巳', '寅', '亥'), ('戌', '午', '寅'), ('午', '丑', '申'), ('寅', '申', '寅'), ('子', '巳', '戌'), ('未', '亥', '卯'), ('申', '亥', '寅'), ('辰', '午', '申'), ('辰', '巳', '午')],
    51: [('亥', '辰', '戌'), ('戌', '酉', '申'), ('寅', '子', '戌'), ('巳', '寅', '亥'), ('子', '申', '辰'), ('午', '丑', '申'), ('巳', '亥', '巳'), ('寅', '未', '子'), ('未', '亥', '卯'), ('戌', '丑', '辰'), ('申', '戌', '子'), ('丑', '寅', '卯')],
    52: [('亥', '午', '子'), ('戌', '酉', '申'), ('寅', '子', '戌'), ('巳', '寅', '亥'), ('戌', '午', '寅'), ('午', '丑', '申'), ('午', '子', '午'), ('辰', '酉', '寅'), ('未', '亥', '卯'), ('酉', '子', '卯'), ('申', '戌', '子'), ('丑', '寅', '卯')],
    53: [('亥', '申', '寅'), ('戌', '酉', '申'), ('午', '辰', '寅'), ('巳', '寅', '亥'), ('子', '申', '辰'), ('午', '丑', '申'), ('寅', '申', '寅'), ('辰', '酉', '寅'), ('未', '亥', '卯'), ('巳', '申', '亥'), ('子', '寅', '辰'), ('丑', '寅', '卯')],
    54: [('亥', '戌', '未'), ('戌', '酉', '申'), ('午', '辰', '寅'), ('巳', '寅', '亥'), ('未', '卯', '亥'), ('午', '丑', '申'), ('巳', '亥', '巳'), ('辰', '酉', '寅'), ('未', '亥', '卯'), ('辰', '未', '戌'), ('子', '寅', '辰'), ('亥', '子', '丑')],
    55: [('丑', '戌', '未'), ('子', '亥', '戌'), ('亥', '酉', '未'), ('戌', '未', '辰'), ('巳', '丑', '酉'), ('卯', '戌', '巳'), ('未', '丑', '未'), ('午', '亥', '辰'), ('酉', '丑', '巳'), ('辰', '未', '戌'), ('卯', '巳', '未'), ('寅', '卯', '辰')],
    56: [('丑', '戌', '未'), ('丑', '子', '亥'), ('丑', '亥', '酉'), ('戌', '未', '辰'), ('未', '卯', '亥'), ('卯', '戌', '巳'), ('卯', '酉', '卯'), ('午', '亥', '辰'), ('酉', '丑', '巳'), ('酉', '子', '卯'), ('未', '酉', '亥'), ('辰', '巳', '午')],
    57: [('丑', '戌', '未'), ('卯', '寅', '丑'), ('丑', '亥', '酉'), ('戌', '未', '辰'), ('巳', '丑', '酉'), ('卯', '戌', '巳'), ('巳', '亥', '巳'), ('午', '亥', '辰'), ('酉', '丑', '巳'), ('申', '亥', '寅'), ('未', '酉', '亥'), ('未', '申', '酉')],
    58: [('丑', '戌', '未'), ('巳', '辰', '卯'), ('巳', '卯', '丑'), ('戌', '未', '辰'), ('巳', '丑', '酉'), ('卯', '戌', '巳'), ('未', '丑', '未'), ('巳', '戌', '卯'), ('酉', '丑', '巳'), ('辰', '未', '戌'), ('巳', '未', '酉'), ('申', '寅', '申')],
    59: [('丑', '戌', '未'), ('未', '午', '巳'), ('未', '巳', '卯'), ('午', '卯', '子'), ('巳', '丑', '酉'), ('亥', '午', '丑'), ('卯', '酉', '卯'), ('未', '子', '巳'), ('酉', '丑', '巳'), ('辰', '未', '戌'), ('丑', '卯', '巳'), ('亥', '子', '丑')],
    60: [('丑', '戌', '未'), ('戌', '酉', '申'), ('未', '巳', '卯'), ('巳', '寅', '亥'), ('未', '卯', '亥'), ('卯', '戌', '巳'), ('巳', '亥', '巳'), ('午', '亥', '辰'), ('酉', '丑', '巳'), ('辰', '未', '戌'), ('丑', '卯', '巳'), ('丑', '寅', '卯')],
}


def get_san_chuan(day_index: int, hour_index: int) -> Tuple[str, str, str]:
    """
    获取三传
    
    Args:
        day_index: 日干支在六十甲子中的序号（1-60）
        hour_index: 时辰索引（0-11，子时为0）
        
    Returns:
        三传元组 (初传, 中传, 末传)
    """
    if day_index < 1 or day_index > 60:
        raise ValueError(f"日干支序号必须在1-60之间: {day_index}")
    if hour_index < 0 or hour_index > 11:
        raise ValueError(f"时辰索引必须在0-11之间: {hour_index}")
    
    return SAN_CHUAN_TABLE[day_index][hour_index]


def get_san_chuan_by_gan_zhi(day_gan_zhi: str, hour_zhi: str) -> Tuple[str, str, str]:
    """
    根据日干支和时辰地支获取三传
    
    Args:
        day_gan_zhi: 日干支，如"甲子"
        hour_zhi: 时辰地支，如"子"
        
    Returns:
        三传元组 (初传, 中传, 末传)
    """
    from .xunkong import JIA_ZI_60
    
    if day_gan_zhi not in JIA_ZI_60:
        raise ValueError(f"无效的日干支: {day_gan_zhi}")
    
    day_index = JIA_ZI_60.index(day_gan_zhi) + 1
    
    if hour_zhi not in SHI_CHEN:
        raise ValueError(f"无效的时辰地支: {hour_zhi}")
    
    hour_index = SHI_CHEN.index(hour_zhi)
    
    return get_san_chuan(day_index, hour_index)


def format_san_chuan(san_chuan: Tuple[str, str, str]) -> str:
    """
    格式化三传输出
    
    Args:
        san_chuan: 三传元组
        
    Returns:
        格式化字符串
    """
    chu, zhong, mo = san_chuan
    return f"初传:{chu} 中传:{zhong} 末传:{mo}"
